{"version":3,"sources":["index.js"],"names":["ANIMATE_LINES","SETUP_ZOOM_AND_BG","n_lines","parseInt","n_entries","mult","d3","select","selectAll","remove","create_data","start_at","data","i","line","j","offset","shuffle","last","length","push","margin","top","right","bottom","left","width","style","height","xScale","scaleLinear","range","yScale","color","scaleOrdinal","schemeCategory10","domain","xAxis","axisBottom","scale","yAxis","axisLeft","curve","curveStep","x","d","y","svg","attr","append","zoomed","console","log","event","transform","call","zoom","scaleExtent","on","extent","flat","animate","text","lines","enter","resize","ticks","Math","max","has_run","transition","delay","duration","repeat","active","styleTween","tweenDash","ease","easeLinear","Debouncer","lookup","identifier","timer_id","clearTimeout","ms","cb","cancel","new_timer_id","setTimeout","debounce","window","set","l","getTotalLength","interpolateString","t","tweenBack"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA,IAAIA,aAAa,GAAG,KAApB,EACA;;AAEA,IAAIC,iBAAiB,GAAG,KAAxB;AACA,IAAIC,OAAO,GAAGC,QAAQ,WAAR,IAAiC,GAA/C;AACA,IAAIC,SAAS,GAAGD,QAAQ,WAAR,IAAmC,GAAnD,EACA;;AACA,IAAIE,IAAI,GAAGF,QAAQ,WAAR,IAA8B,IAAzC,EAA+C;AAC/C;AAEA;AACA;;AACAG,EAAE,CAACC,MAAH,CAAU,QAAV,EACGC,SADH,CACa,GADb,EAEGC,MAFH,IAIA;AACA;;AACA,SAASC,WAAT,GAAuB;AACrB,MAAIC,QAAQ,GAAG,EAAET,OAAO,GAAG,CAAZ,CAAf,CADqB,CAErB;;AACA,MAAIU,IAAI,GAAG,EAAX;;AACA,OAAK,IAAIC,CAAC,GAAGF,QAAb,EAAuBE,CAAC,GAAGX,OAAO,GAAGS,QAArC,EAA+CE,CAAC,EAAhD,EAAoD;AAClD;AACA,QAAIC,KAAI,GAAG,CAACD,CAAC,GAAGR,IAAL,CAAX,CAFkD,CAGlD;AACA;AACA;;AACA,SAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGX,SAApB,EAA+BW,CAAC,EAAhC,EAAoC;AAClC,UAAIC,MAAM,GAAGV,EAAE,CAACW,OAAH,CAAW,CAAC,CAAC,CAAF,EAAK,CAAL,CAAX,EAAoB,CAApB,CAAb;AACA,UAAIC,IAAI,GAAGJ,KAAI,CAACA,KAAI,CAACK,MAAL,GAAc,CAAf,CAAf;;AACAL,MAAAA,KAAI,CAACM,IAAL,CAAUF,IAAI,GAAGF,MAAjB;AACD;;AACDJ,IAAAA,IAAI,CAACQ,IAAL,CAAUN,KAAV;AACD;;AAED,SAAOF,IAAP;AACD;;AAED,IAAIA,IAAI,GAAGF,WAAW,EAAtB,EAEA;AACA;;AACA,IAAIW,MAAM,GAAG;AAAEC,EAAAA,GAAG,EAAE,EAAP;AAAWC,EAAAA,KAAK,EAAE,CAAlB;AAAqBC,EAAAA,MAAM,EAAE,EAA7B;AAAiCC,EAAAA,IAAI,EAAE;AAAvC,CAAb;AAAA,IACEC,KAAK,GACHvB,QAAQ,CAACG,EAAE,CAACC,MAAH,CAAU,QAAV,EAAoBoB,KAApB,CAA0B,OAA1B,CAAD,CAAR,GAA+CN,MAAM,CAACI,IAAtD,GAA6DJ,MAAM,CAACE,KAFxE;AAAA,IAGEK,MAAM,GACJzB,QAAQ,CAACG,EAAE,CAACC,MAAH,CAAU,QAAV,EAAoBoB,KAApB,CAA0B,QAA1B,CAAD,CAAR,GAAgDN,MAAM,CAACC,GAAvD,GAA6DD,MAAM,CAACG,MAJxE,EAMA;AACA;AAEA;AACA;;AACA,IAAIK,MAAM,GAAGvB,EAAE,CAACwB,WAAH,GAAiBC,KAAjB,CAAuB,CAAC,CAAD,EAAIL,KAAJ,CAAvB,CAAb;AACA,IAAIM,MAAM,GAAG1B,EAAE,CAACwB,WAAH,GAAiBC,KAAjB,CAAuB,CAACH,MAAD,EAAS,CAAT,CAAvB,CAAb;AACA,IAAIK,KAAK,GAAG3B,EAAE,CACX4B,YADS,GAETH,KAFS,CAEHzB,EAAE,CAAC6B,gBAFA,EAGTC,MAHS,CAGF,CAAC,CAAD,EAAIxB,IAAI,CAACO,MAAT,CAHE,CAAZ,EAKA;;AACA,IAAIkB,KAAK,GAAG/B,EAAE,CAACgC,UAAH,GAAgBC,KAAhB,CAAsBV,MAAtB,CAAZ;AACA,IAAIW,KAAK,GAAGlC,EAAE,CAACmC,QAAH,GAAcF,KAAd,CAAoBP,MAApB,CAAZ,EAEA;;AACA,IAAIlB,IAAI,GAAGR,EAAE,CACVQ,IADQ,GAER4B,KAFQ,CAEFpC,EAAE,CAACqC,SAFD,EAGT;AACA;AAJS,CAKRC,CALQ,CAKN,UAASC,CAAT,EAAYhC,CAAZ,EAAe;AAChB,SAAOgB,MAAM,CAAChB,CAAD,CAAb,CADgB,CAEhB;AACD,CARQ,EASRiC,CATQ,CASN,UAASD,CAAT,EAAYhC,CAAZ,EAAe;AAChB,SAAOmB,MAAM,CAACa,CAAD,CAAb,CADgB,CAEhB;AACD,CAZQ,CAAX,EAcA;;AACA,IAAIE,GAAG,GAAGzC,EAAE,CACTC,MADO,CACA,QADA,EAEPyC,IAFO,CAEF,OAFE,EAEOtB,KAAK,GAAGL,MAAM,CAACI,IAAf,GAAsBJ,MAAM,CAACE,KAFpC,EAGPyB,IAHO,CAGF,QAHE,EAGQpB,MAAM,GAAGP,MAAM,CAACC,GAAhB,GAAsBD,MAAM,CAACG,MAHrC,EAIPyB,MAJO,CAIA,GAJA,EAKPD,IALO,CAKF,WALE,EAKW,eAAe3B,MAAM,CAACI,IAAtB,GAA6B,GAA7B,GAAmCJ,MAAM,CAACC,GAA1C,GAAgD,GAL3D,CAAV;AAOAyB,GAAG,GAAGA,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBD,IAAhB,CAAqB,IAArB,EAA2B,OAA3B,CAAN;;AAEA,IAAI/C,iBAAJ,EAAuB;AAAA,MAKZiD,MALY,GAKrB,SAASA,MAAT,GAAkB;AAChBC,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA9C,IAAAA,EAAE,CAACC,MAAH,CAAU,UAAV,EAAsByC,IAAtB,CAA2B,WAA3B,EAAwC1C,EAAE,CAAC+C,KAAH,CAASC,SAAjD;AACD,GARoB;;AACrBP,EAAAA,GAAG,CACAE,MADH,CACU,MADV,EAEGD,IAFH,CAEQ,OAFR,EAEiBtB,KAAK,GAAGL,MAAM,CAACI,IAAf,GAAsBJ,MAAM,CAACE,KAF9C,EAGGyB,IAHH,CAGQ,QAHR,EAGkBpB,MAAM,GAAGP,MAAM,CAACC,GAAhB,GAAsBD,MAAM,CAACG,MAH/C;AAQAlB,EAAAA,EAAE,CAACC,MAAH,CAAU,UAAV,EAAsBgD,IAAtB,CACEjD,EAAE,CACCkD,IADH,GAEGC,WAFH,CAEe,CAAC,IAAI,CAAL,EAAQ,CAAR,CAFf,EAGGC,EAHH,CAGM,MAHN,EAGcR,MAHd,CADF;AAMD,EAED;AACA;;;AACArB,MAAM,CAACO,MAAP,CAAc,CAAC,CAAD,EAAIxB,IAAI,CAAC,CAAD,CAAJ,CAAQO,MAAZ,CAAd,GAEA;;AACAa,MAAM,CAACI,MAAP,CACE9B,EAAE,CAACqD,MAAH,CAAU/C,IAAI,CAACgD,IAAL,EAAV,EAAuB,UAASf,CAAT,EAAYhC,CAAZ,EAAe;AACpC,SAAOgC,CAAP;AACD,CAFD,CADF,GAMA;AACA;AACA;;AACAE,GAAG,CAACW,EAAJ,CAAO,OAAP,EAAgBG,OAAhB,GACA;;AACAd,GAAG,CACAE,MADH,CACU,GADV,EAEGD,IAFH,CAEQ,OAFR,EAEiB,QAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,iBAAiBpB,MAAjB,GAA0B,GAH/C,EAIG2B,IAJH,CAIQlB,KAJR,EAKGY,MALH,CAKU,MALV,EAMGD,IANH,CAMQ,OANR,EAMiB,OANjB,EAOGA,IAPH,CAOQ,GAPR,EAOa,EAPb,EAQGA,IARH,CAQQ,GARR,EAQa,EARb,EASGA,IATH,CASQ,IATR,EASc,OATd,EAUE;AAVF,CAWGrB,KAXH,CAWS,aAXT,EAWwB,WAXxB,EAYGmC,IAZH,CAYQ,MAZR;AAcAf,GAAG,CACAE,MADH,CACU,GADV,EAEGD,IAFH,CAEQ,OAFR,EAEiB,QAFjB,EAGGO,IAHH,CAGQf,KAHR,EAIGS,MAJH,CAIU,MAJV,EAKGD,IALH,CAKQ,OALR,EAKiB,OALjB,EAMGA,IANH,CAMQ,GANR,EAMa,EANb,EAOGA,IAPH,CAOQ,GAPR,EAOa,CAAC,EAPd,EAQGA,IARH,CAQQ,IARR,EAQc,OARd,EASE;AATF,CAUGrB,KAVH,CAUS,aAVT,EAUwB,WAVxB,EAWGmC,IAXH,CAWQ,GAXR,GAaA;;AACA,IAAIC,KAAK,GAAGhB,GAAG,CACZvC,SADS,CACC,UADD,EAETI,IAFS,CAEJA,IAFI,EAGToD,KAHS,GAITf,MAJS,CAIF,GAJE,EAKTD,IALS,CAKJ,OALI,EAKK,SALL,CAAZ;AAOAe,KAAK,CACFd,MADH,CACU,MADV,EAEGD,IAFH,CAEQ,OAFR,EAEiB,MAFjB,EAGGA,IAHH,CAGQ,GAHR,EAGa,UAASH,CAAT,EAAY;AACrB;AACA,SAAO/B,IAAI,CAAC+B,CAAD,CAAX;AACD,CANH,EAOGlB,KAPH,CAOS,QAPT,EAOmB,UAASkB,CAAT,EAAYhC,CAAZ,EAAe;AAC9B,SAAOoB,KAAK,CAACpB,CAAD,CAAZ,CAD8B,CAE9B;AACD,CAVH,GAYA;AACA;AACA;AACA;AAEA;AAEA;;AACA,SAASoD,MAAT,GAAkB;AAChB,MAAIvC,KAAK,GACLvB,QAAQ,CAACG,EAAE,CAACC,MAAH,CAAU,QAAV,EAAoBoB,KAApB,CAA0B,OAA1B,CAAD,CAAR,GAA+CN,MAAM,CAACI,IAAtD,GAA6DJ,MAAM,CAACE,KADxE;AAAA,MAEEK,MAAM,GACJzB,QAAQ,CAACG,EAAE,CAACC,MAAH,CAAU,QAAV,EAAoBoB,KAApB,CAA0B,QAA1B,CAAD,CAAR,GACAN,MAAM,CAACC,GADP,GAEAD,MAAM,CAACG,MALX,CADgB,CAQhB;;AACAK,EAAAA,MAAM,CAACE,KAAP,CAAa,CAAC,CAAD,EAAIL,KAAJ,CAAb;AACAM,EAAAA,MAAM,CAACD,KAAP,CAAa,CAACH,MAAD,EAAS,CAAT,CAAb,EAVgB,CAYhB;;AACAmB,EAAAA,GAAG,CACAxC,MADH,CACU,SADV,EAEGyC,IAFH,CAEQ,WAFR,EAEqB,iBAAiBpB,MAAjB,GAA0B,GAF/C,EAGG2B,IAHH,CAGQlB,KAHR;AAKAU,EAAAA,GAAG,CAACxC,MAAJ,CAAW,SAAX,EAAsBgD,IAAtB,CAA2Bf,KAA3B,EAlBgB,CAoBhB;;AAEAO,EAAAA,GAAG,CAACvC,SAAJ,CAAc,OAAd,EAAuBwC,IAAvB,CAA4B,GAA5B,EAAiC,UAASH,CAAT,EAAY;AAC3C,WAAO/B,IAAI,CAAC+B,CAAD,CAAX;AACD,GAFD,EAtBgB,CAyBhB;;AAEA,MAAI7C,aAAJ,EAAmB;AACjB6D,IAAAA,OAAO;AACR,GA7Be,CA+BhB;AAEA;;;AACAxB,EAAAA,KAAK,CAAC6B,KAAN,CAAYC,IAAI,CAACC,GAAL,CAAS1C,KAAK,GAAG,EAAjB,EAAqB,CAArB,CAAZ;AACAc,EAAAA,KAAK,CAAC0B,KAAN,CAAYC,IAAI,CAACC,GAAL,CAASxC,MAAM,GAAG,EAAlB,EAAsB,CAAtB,CAAZ;AACD,EAED;;;AACA,IAAIyC,OAAO,GAAG,KAAd;;AAEA,SAASR,OAAT,GAAmB;AACjB,MAAIQ,OAAJ,EAAa;AACX;AACD;;AACDlB,EAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACAiB,EAAAA,OAAO,GAAG,IAAV;AACAtB,EAAAA,GAAG,CACAvC,SADH,CACa,OADb,EAEGwC,IAFH,CAEQ,kBAFR,EAE4B,UAF5B,EAGGsB,UAHH,GAIGC,KAJH,CAIS,UAAC1B,CAAD,EAAIhC,CAAJ;AAAA,WAAUA,CAAC,GAAG,IAAd;AAAA,GAJT,EAKG2D,QALH,CAKY,KALZ,EAMGd,EANH,CAMM,OANN,EAMe,SAASe,MAAT,GAAkB;AAC7BnE,IAAAA,EAAE,CAACoE,MAAH,CAAU,IAAV,EACGC,UADH,CACc,kBADd,EACkCC,SADlC,EAEGC,IAFH,CAEQvE,EAAE,CAACwE,UAFX,EAGGR,UAHH;AAID,GAXH;AAYD;;IAEKS;;;AACJ,uBAAc;AAAA;;AACZ,SAAKC,MAAL,GAAc,EAAd;AACD;;;;2BACMC,YAAY;AACjB,UAAIC,QAAQ,GAAG,KAAKF,MAAL,CAAYC,UAAZ,CAAf;;AACA,UAAIC,QAAJ,EAAc;AACZC,QAAAA,YAAY,CAACD,QAAD,CAAZ;AACA,eAAO,KAAKF,MAAL,CAAYE,QAAZ,CAAP;AACD;AACF;;;wBACGD,YAAYG,IAAIC,IAAI;AACtB,WAAKC,MAAL,CAAYL,UAAZ;AACA,UAAIM,YAAY,GAAGC,UAAU,CAACH,EAAD,EAAKD,EAAL,CAA7B;AACA,WAAKJ,MAAL,CAAYC,UAAZ,IAA0BM,YAA1B;AACD;;;;;;AAGH,IAAIE,QAAQ,GAAG,IAAIV,SAAJ,EAAf,EAEA;;AACAzE,EAAE,CAACC,MAAH,CAAUmF,MAAV,EAAkBhC,EAAlB,CAAqB,QAArB,EAA+B;AAAA,SAAM+B,QAAQ,CAACE,GAAT,CAAa,SAAb,EAAwB,GAAxB,EAA6B1B,MAA7B,CAAN;AAAA,CAA/B,GACA;AAEA;;AACAA,MAAM;;AAEN,SAASW,SAAT,GAAqB;AACnB,MAAIgB,CAAC,GAAG,KAAKC,cAAL,EAAR;AAAA,MACEhF,CAAC,GAAGP,EAAE,CAACwF,iBAAH,CAAqB,OAAOF,CAA5B,EAA+BA,CAAC,GAAG,GAAJ,GAAUA,CAAzC,CADN;AAEA,SAAO,UAASG,CAAT,EAAY;AACjB,WAAOlF,CAAC,CAACkF,CAAD,CAAR;AACD,GAFD;AAGD;;AAED,SAASC,SAAT,GAAqB;AACnB,MAAIJ,CAAC,GAAG,KAAKC,cAAL,EAAR;AAAA,MACEhF,CAAC,GAAGP,EAAE,CAACwF,iBAAH,CAAqBF,CAAC,GAAG,IAAzB,EAA+B,OAAOA,CAAtC,CADN;AAEA,SAAO,UAASG,CAAT,EAAY;AACjB,WAAOlF,CAAC,CAACkF,CAAD,CAAR;AACD,GAFD;AAGD","file":"randomwalks.e31bb0bc.map","sourceRoot":"..","sourcesContent":["// https://bl.ocks.org/josiahdavis/7a02e811360ff00c4eef\n\nlet ANIMATE_LINES = false;\n// ANIMATE_LINES = true;\n\nlet SETUP_ZOOM_AND_BG = false;\nlet n_lines = parseInt(process.env.N_LINES) || 200;\nlet n_entries = parseInt(process.env.N_ENTRIES) || 150;\n// let mult = parseInt(process.env.MULT) || 0; // 1 gives us touching grid, 2 gives us spacing  stairs, 0 gives us a tree\nlet mult = parseInt(process.env.MULT) || 0.01; // 1 gives us touching grid, 2 gives us spacing  stairs, 0 gives us a tree\n// let n_lines = 3;\n\n// console.log(process.env.DB_HOST);\n// reset for hmr in dev\nd3.select(\"#chart\")\n  .selectAll(\"*\")\n  .remove();\n\n// console.log(process.env.MULT)\n// generate my data\nfunction create_data() {\n  let start_at = -(n_lines / 2);\n  // let start_at = -5;\n  let data = [];\n  for (var i = start_at; i < n_lines + start_at; i++) {\n    //better\n    let line = [i * mult];\n    // let line = d3.range(-n_lines / 2 + i * mult, n_lines / 2 + i * mult);\n    // for simpler debugging\n    // let line = d3.range(-5 + i, 5 + i);\n    for (var j = 0; j < n_entries; j++) {\n      let offset = d3.shuffle([-1, 1])[0];\n      let last = line[line.length - 1];\n      line.push(last + offset);\n    }\n    data.push(line);\n  }\n\n  return data;\n}\n\nlet data = create_data();\n\n// const csv_file_path = require(\"./giniLine.csv\");\n// Define margins\nvar margin = { top: 20, right: 0, bottom: 30, left: 50 },\n  width =\n    parseInt(d3.select(\"#chart\").style(\"width\")) - margin.left - margin.right,\n  height =\n    parseInt(d3.select(\"#chart\").style(\"height\")) - margin.top - margin.bottom;\n\n// Define date parser\n// var parseDate = d3.timeParse(\"%Y-%m-%d %H:%M:%S\");\n\n// Define scales\n// var xScale = d3.scaleTime().range([0, width]);\nvar xScale = d3.scaleLinear().range([0, width]);\nvar yScale = d3.scaleLinear().range([height, 0]);\nvar color = d3\n  .scaleOrdinal()\n  .range(d3.schemeCategory10)\n  .domain([0, data.length]);\n\n// Define axes\nvar xAxis = d3.axisBottom().scale(xScale);\nvar yAxis = d3.axisLeft().scale(yScale);\n\n// Define lines\nvar line = d3\n  .line()\n  .curve(d3.curveStep)\n  // .curve(d3.curveStepAfter)\n  // .curve(d3.curveMonotoneX)\n  .x(function(d, i) {\n    return xScale(i);\n    // return xScale(d[\"date\"]);\n  })\n  .y(function(d, i) {\n    return yScale(d);\n    // return yScale(d[\"concentration\"]);\n  });\n\n// Define svg canvas\nvar svg = d3\n  .select(\"#chart\")\n  .attr(\"width\", width + margin.left + margin.right)\n  .attr(\"height\", height + margin.top + margin.bottom)\n  .append(\"g\")\n  .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\nsvg = svg.append(\"g\").attr(\"id\", \"graph\");\n\nif (SETUP_ZOOM_AND_BG) {\n  svg\n    .append(\"rect\")\n    .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + margin.bottom);\n  function zoomed() {\n    console.log(\"zoomm?\");\n    d3.select(\"g#graph \").attr(\"transform\", d3.event.transform);\n  }\n  d3.select(\"g#graph \").call(\n    d3\n      .zoom()\n      .scaleExtent([1 / 2, 4])\n      .on(\"zoom\", zoomed)\n  );\n}\n\n// Set the domain of the axes\n// hacky, assumes they're all the same length, we use the first one XXX\nxScale.domain([0, data[0].length]);\n\n// this fits them all\nyScale.domain(\n  d3.extent(data.flat(), function(d, i) {\n    return d;\n  })\n);\n\n//  for close up debug\n// xScale.domain([0, data[0].length / 2]);\n// yScale.domain([0, 25]);\nsvg.on(\"click\", animate);\n// Place the axes on the chart\nsvg\n  .append(\"g\")\n  .attr(\"class\", \"x axis\")\n  .attr(\"transform\", \"translate(0,\" + height + \")\")\n  .call(xAxis)\n  .append(\"text\")\n  .attr(\"class\", \"label\")\n  .attr(\"y\", 15)\n  .attr(\"x\", 55)\n  .attr(\"dy\", \".71em\")\n  // .attr(\"dx\", \".71em\")\n  .style(\"text-anchor\", \"beginning\")\n  .text(\"time\");\n\nsvg\n  .append(\"g\")\n  .attr(\"class\", \"y axis\")\n  .call(yAxis)\n  .append(\"text\")\n  .attr(\"class\", \"label\")\n  .attr(\"y\", 25)\n  .attr(\"x\", -35)\n  .attr(\"dy\", \".71em\")\n  // .attr(\"dx\", \".71em\")\n  .style(\"text-anchor\", \"beginning\")\n  .text(\"Y\");\n\n// console.log(data);\nvar lines = svg\n  .selectAll(\".trend_g\")\n  .data(data)\n  .enter()\n  .append(\"g\")\n  .attr(\"class\", \"trend_g\");\n\nlines\n  .append(\"path\")\n  .attr(\"class\", \"line\")\n  .attr(\"d\", function(d) {\n    // console.log(d);\n    return line(d);\n  })\n  .style(\"stroke\", function(d, i) {\n    return color(i);\n    // return \"black\";\n  });\n\n// console.log(JSON.stringify(d3.values(concentrations), null, 2)) // to view the structure\n// console.log(d3.values(concentrations)); // to view the structure\n// console.log(concentrations);\n// console.log(concentrations.map(function()))\n\n// });\n\n// Define responsive behavior\nfunction resize() {\n  var width =\n      parseInt(d3.select(\"#chart\").style(\"width\")) - margin.left - margin.right,\n    height =\n      parseInt(d3.select(\"#chart\").style(\"height\")) -\n      margin.top -\n      margin.bottom;\n\n  // Update the range of the scale with new width/height\n  xScale.range([0, width]);\n  yScale.range([height, 0]);\n\n  // Update the axis and text with the new scale\n  svg\n    .select(\".x.axis\")\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(xAxis);\n\n  svg.select(\".y.axis\").call(yAxis);\n\n  // Force D3 to recalculate and update the line\n\n  svg.selectAll(\".line\").attr(\"d\", function(d) {\n    return line(d);\n  });\n  // and do our animation\n\n  if (ANIMATE_LINES) {\n    animate();\n  }\n\n  // .on(\"start\", repeat);\n\n  // Update the tick marks\n  xAxis.ticks(Math.max(width / 75, 2));\n  yAxis.ticks(Math.max(height / 50, 2));\n}\n\n// hacky flag\nlet has_run = false;\n\nfunction animate() {\n  if (has_run) {\n    return;\n  }\n  console.log(\"animating!\");\n  has_run = true;\n  svg\n    .selectAll(\".line\")\n    .attr(\"stroke-dasharray\", \"0 100000\")\n    .transition()\n    .delay((d, i) => i * 1000)\n    .duration(20000)\n    .on(\"start\", function repeat() {\n      d3.active(this)\n        .styleTween(\"stroke-dasharray\", tweenDash)\n        .ease(d3.easeLinear)\n        .transition();\n    });\n}\n\nclass Debouncer {\n  constructor() {\n    this.lookup = {};\n  }\n  cancel(identifier) {\n    let timer_id = this.lookup[identifier];\n    if (timer_id) {\n      clearTimeout(timer_id);\n      delete this.lookup[timer_id];\n    }\n  }\n  set(identifier, ms, cb) {\n    this.cancel(identifier);\n    let new_timer_id = setTimeout(cb, ms);\n    this.lookup[identifier] = new_timer_id;\n  }\n}\n\nlet debounce = new Debouncer();\n\n// Call the resize function whenever a resize event occurs\nd3.select(window).on(\"resize\", () => debounce.set(\"resized\", 450, resize));\n// need debounce!  XXX\n\n// Call the resize function\nresize();\n\nfunction tweenDash() {\n  var l = this.getTotalLength(),\n    i = d3.interpolateString(\"0,\" + l, l + \",\" + l);\n  return function(t) {\n    return i(t);\n  };\n}\n\nfunction tweenBack() {\n  var l = this.getTotalLength(),\n    i = d3.interpolateString(l + \",0\", \"0,\" + l);\n  return function(t) {\n    return i(t);\n  };\n}\n"]}